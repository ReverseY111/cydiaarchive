#!/bin/bash

#If the extension is being installed, create the symlinks to the iOS specific dylib / bundle
if [[ $1 == configure ]]; then
    if [[ ! -e /Library/MobileSubstrate/DynamicLibraries/AndroidLock.dylib ]]; then
        IOS_CURRENT_VER=`sw_vers -productVersion`
        IOS8="8"
        IOS7="7"
        IOS6="6"
        IOS5="5"

        if [[ "$IOS_CURRENT_VER" == "$IOS8" ]] || [[ "$IOS_CURRENT_VER" > "$IOS8" ]]; then
            ln -s /Library/MobileSubstrate/DynamicLibraries/AndroidLock/AndroidLock-ios8.dylib /Library/MobileSubstrate/DynamicLibraries/AndroidLock.dylib
            ln -s /Library/PreferenceBundles/AndroidLock/AndroidLockSettings.bundle-ios8 /Library/PreferenceBundles/AndroidLockSettings.bundle
        elif [[ "$IOS_CURRENT_VER" == "$IOS7" ]] || [[ "$IOS_CURRENT_VER" > "$IOS7" ]]; then
            ln -s /Library/MobileSubstrate/DynamicLibraries/AndroidLock/AndroidLock-ios7.dylib /Library/MobileSubstrate/DynamicLibraries/AndroidLock.dylib
            ln -s /Library/PreferenceBundles/AndroidLock/AndroidLockSettings.bundle-ios7 /Library/PreferenceBundles/AndroidLockSettings.bundle
        elif [[ "$IOS_CURRENT_VER" == "$IOS6" ]] || [[ "$IOS_CURRENT_VER" > "$IOS6" ]]; then
            ln -s /Library/MobileSubstrate/DynamicLibraries/AndroidLock/AndroidLock-ios6.dylib /Library/MobileSubstrate/DynamicLibraries/AndroidLock.dylib
            ln -s /Library/PreferenceBundles/AndroidLock/AndroidLockSettings.bundle-ios6 /Library/PreferenceBundles/AndroidLockSettings.bundle
        elif [[ "$IOS_CURRENT_VER" == "$IOS5" ]] || [[ "$IOS_CURRENT_VER" > "$IOS5" ]]; then
            ln -s /Library/MobileSubstrate/DynamicLibraries/AndroidLock/AndroidLock-ios5.dylib /Library/MobileSubstrate/DynamicLibraries/AndroidLock.dylib
            ln -s /Library/PreferenceBundles/AndroidLock/AndroidLockSettings.bundle-ios5 /Library/PreferenceBundles/AndroidLockSettings.bundle
        else
            ln -s /Library/MobileSubstrate/DynamicLibraries/AndroidLock/AndroidLock-ios3-ios4.dylib /Library/MobileSubstrate/DynamicLibraries/AndroidLock.dylib
            ln -s /Library/PreferenceBundles/AndroidLock/AndroidLockSettings.bundle-ios3-ios4 /Library/PreferenceBundles/AndroidLockSettings.bundle
        fi
    fi
fi

echo
echo "Respring!!!"
echo "Respring!!!"
echo "Respring!!!"
echo "Cracked by julioverne"
echo
